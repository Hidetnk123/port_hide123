<%= render "shared/header" %>

<%# 商品の概要 %>
<div class="item-show">
  <div class="item-box">
    <div class='item-img-contents'>
      <% @product.images.each do |image|%>
        <%= image_tag image, class:"item-box-img" %>
      <% end %>
    </div>
    <div class="item-explain-box">
      <span><%= @product.text %></span>
    </div>

    <%# ログインしているユーザと出品しているユーザが同一人物である時、商品の編集と削除を表示にしましょう%>
    <% if user_signed_in? && @product.user.id == current_user.id %>
    <%= link_to '商品の編集', edit_product_path(@product.id), method: :get, class: "item-red-btn" %>
    <p class='or-text'>or</p>
    <%= link_to '削除', product_path(@product.id), method: :delete, class:'item-destroy' %>
    <% end %>
    
    <%# // ログインしているユーザと出品しているユーザが同一人物である時、商品の編集と削除を表示にしましょう %>

  </div>
  <%# /商品の概要 %>

  <div class="comment-box">
       <% if current_user %>
        <%= form_with(model: [@product, @comment], local: true) do |form| %>
          <%= form.text_area :text, placeholder: "コメントする", class:"comment-text" %>
          <button type="submit" class="comment-btn">
            <%= image_tag "comment.png" ,class:"comment-flag-icon" ,width:"20",height:"25"%>
            <span>コメントする<span>
          </button>
      <% end %>
    <% else %>
      <strong><p>※※※ コメントの投稿には新規登録/ログインが必要です ※※※</p></strong>
    <% end %>
    <div class="comments">
      <h4>＜コメント一覧＞</h4>
      <% if @comments %>
        <% @comments.each do |comment| %>
          <p>
            <strong><%= link_to comment.user.nickname, "/users/#{comment.user_id}" %>：</strong>
            <%= comment.text %>
          </p>
          <p><%=link_to "削除", product_comment_path(comment.product.id, comment.id), method: :delete %></p>
        <% end %>
      <% end %>
    </div>
  </div>
</div>